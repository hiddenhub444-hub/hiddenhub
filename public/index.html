<!DOCTYPE html>
<html>
<head>
    <title>H1DD3N PROTECTER</title>
    <style>
        body { background: #000; color: #8a2be2; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .box { background: #0a0a0a; padding: 25px; border: 1px solid #8a2be2; width: 90%; max-width: 600px; text-align: center; border-radius: 10px; box-shadow: 0 0 15px #8a2be2; }
        textarea { width: 100%; height: 250px; background: #000; color: #0f0; border: 1px solid #333; margin-bottom: 15px; padding: 10px; box-sizing: border-box; }
        .gen-btn { background: #8a2be2; color: white; padding: 12px 25px; border: none; cursor: pointer; font-weight: bold; transition: 0.3s; width: 100%; }
        .gen-btn:hover { background: #a042ff; box-shadow: 0 0 10px #a042ff; }
        #status { color: #555; font-size: 13px; margin-top: 15px; }
        .discord-link { margin-top: 20px; display: block; text-decoration: none; color: #7289da; font-weight: bold; font-size: 14px; }
        .discord-link img { vertical-align: middle; width: 24px; margin-right: 8px; }
    </style>
</head>
<body>
    <div class="box">
        <h2 style="letter-spacing: 3px;">H1DD3N PROTECTER</h2>
        <textarea id="input" placeholder="-- Paste your Lua Code here..."></textarea>
        <button class="gen-btn" onclick="generate()">GENERATE LOADSTRING</button>
        
        <p id="status">Secure Session: Ready</p>

        <a href="https://discord.gg/8Pb8sxaS" target="_blank" class="discord-link">
            <img src="https://cdn-icons-png.flaticon.com/512/2111/2111370.png" alt="Discord">
            JOIN THE DISCORD
        </a>
    </div>

    <script>
        async function generate() {
            const code = document.getElementById('input').value;
            const status = document.getElementById('status');
            if(!code) return alert("Paste some code first!");

            status.innerText = "Status: Generating...";

            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ lua: code })
                });

                const data = await response.json();
                const rawUrl = window.location.origin + "/raw/" + data.id;
                
                // Automatically copy the loadstring to clipboard
                const loadstring = 'loadstring(game:HttpGet("' + rawUrl + '"))()';
                await navigator.clipboard.writeText(loadstring);
                
                status.innerText = "Status:  COPIED!";
                status.style.color = "#0f0";
                alert("Successfully Generated!\n\nLoadstring copied to clipboard.");
            } catch (err) {
                status.innerText = "Status: Error generating link.";
                status.style.color = "red";
            }
        }
    </script>
</body>
</html>
